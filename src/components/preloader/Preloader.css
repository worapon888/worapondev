:root {
  --preloader-size: 150px;
  --base-100: #e7f7ff;
  --base-500: rgba(120, 220, 255, 0.9);

  /* ✅ sync time (ปรับให้จบเร็วขึ้น) */
  --overlay-fade: 0.8s;
  --bg-fade: 0.55s;
  --ui-fade: 0.65s;

  /* ✅ ช่วงแตกตัวให้สั้นลง (ต้องตรงกับ TSX: 1250ms) */
  --grid-out: 1.25s;
}

/* Overlay */
.preloader-overlay {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100svh;
  z-index: 9999;
  pointer-events: none;
  overflow: hidden;

  opacity: 1;
  visibility: visible;
  transition:
    opacity var(--overlay-fade) ease,
    visibility var(--overlay-fade) ease;
}

.preloader-overlay--done {
  opacity: 0;
  visibility: hidden;
}

/* Grid layer (behind solid) */
.preloader-grid {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 1;
}

.preloader-block {
  position: absolute;
  background: #000;
  opacity: 1;
  transform: scale(1);
  filter: blur(0);
  will-change: opacity, transform, filter;
}

/* Solid BG (front of grid) */
.preloader-solid {
  position: absolute;
  inset: 0;
  background: #000;
  z-index: 3;
  opacity: 1;
  transition: opacity var(--bg-fade) ease;
}

.preloader--bgfade .preloader-solid {
  opacity: 0;
}

/* =========================
   Phase 2: GRID OUT (ไม่มีค้าง “รอยปริ”)
   ========================= */
.preloader--exiting .preloader-block {
  animation: grid-out var(--grid-out) linear forwards;
  animation-delay: var(--d, 0s);
}

/*
  ✅ เปลี่ยนแนวคิด:
  - ตัดช่วงค้างนิ่งยาวๆ ออก
  - crack มาเร็วขึ้น + ย้ำ 2 ครั้ง
  - ดับจริงเร็วขึ้น
*/
@keyframes grid-out {
  0% {
    opacity: 1;
    transform: scale(1);
    filter: blur(0);
  }

  /* crack #1 (มาไวขึ้น ไม่ค้าง) */
  35% {
    opacity: 0.78;
    transform: scale(0.992);
    filter: blur(0.25px);
  }
  42% {
    opacity: 1;
    transform: scale(0.998);
    filter: blur(0);
  }

  /* crack #2 */
  70% {
    opacity: 0.55;
    transform: scale(0.988);
    filter: blur(0.35px);
  }
  78% {
    opacity: 1;
    transform: scale(0.996);
    filter: blur(0.1px);
  }

  /* ดับจริง */
  100% {
    opacity: 0;
    transform: scale(0.96);
    filter: blur(0.5px);
  }
}

/* Center UI */
.preloader-animation-wrapper {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 4;
}

.preloader-text {
  position: absolute;
  bottom: 6rem;
  z-index: 5;
  color: var(--base-100);
  opacity: 0.12;
  font-size: 0.9rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  animation: preloader-blink 1s ease-in-out infinite;
  animation-delay: 100ms;
}

@keyframes preloader-blink {
  0%,
  100% {
    opacity: 0.12;
  }
  50% {
    opacity: 1;
  }
}

/* ✅ exiting: text/svg หายพร้อมกัน */
.preloader--exiting .preloader-text {
  animation: none;
  opacity: 0;
  transition: opacity var(--ui-fade) linear;
}

.preloader-ring-frame,
.preloader-disc-frame {
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
}

.preloader-ring {
  border: 2px solid rgba(0, 0, 0, 0);
  border-left: 2px solid var(--base-500);
  border-right: 2px solid var(--base-500);
  border-radius: 50%;
  position: absolute;
  opacity: 1;
}

.preloader-ring--sm {
  width: calc(var(--preloader-size) * 0.72);
  height: calc(var(--preloader-size) * 0.72);
  animation: preloader-spin 1s linear infinite;
}

.preloader-ring--md {
  width: calc(var(--preloader-size) * 0.92);
  height: calc(var(--preloader-size) * 0.92);
  animation: preloader-spinner 1.5s linear infinite;
}

.preloader-ring--lg {
  width: calc(var(--preloader-size) * 1.15);
  height: calc(var(--preloader-size) * 1.15);
  animation: preloader-spin 2s linear infinite;
}

.preloader-disc {
  height: var(--preloader-size);
  width: var(--preloader-size);
  border: 2px solid var(--base-500);
  border-radius: 50%;
  animation: preloader-rotate 3s linear infinite;
  position: absolute;
  opacity: 1;
}

@keyframes preloader-rotate {
  100% {
    transform: rotate3d(1, 0.25, 0.75, 360deg);
  }
}

@keyframes preloader-spin {
  to {
    transform: rotateZ(360deg);
  }
}

@keyframes preloader-spinner {
  to {
    transform: rotateZ(-360deg);
  }
}

.preloader--exiting .preloader-ring,
.preloader--exiting .preloader-disc {
  opacity: 0;
  transition: opacity var(--ui-fade) linear;
}

/* กัน overlay--done ซ้อน transition */
.preloader-overlay--done .preloader-ring,
.preloader-overlay--done .preloader-disc,
.preloader-overlay--done .preloader-text {
  opacity: 0;
  transition: none;
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  .preloader-grid .preloader-block,
  .preloader-text,
  .preloader-ring--sm,
  .preloader-ring--md,
  .preloader-ring--lg,
  .preloader-disc {
    animation: none !important;
    transition: none !important;
    filter: none !important;
  }
}
